// Version: v_0.9.0_2025-12-12-12-24-40
'use strict';(function(p){function m(b,a){window.console&&("error"===a?window.console.error("[LeoCDP] "+b):q.DEBUG&&window.console.log("[LeoCDP] "+b))}function w(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(b){return m("XHR not supported.","error"),null}}function u(b){if("string"===typeof b&&0<b.length)try{var a=JSON.parse(b);a.sessionKey&&h!==a.sessionKey&&(h=a.sessionKey,p.LeoEventObserver&&"function"===typeof p.LeoEventObserver.setSessionKey&&
p.LeoEventObserver.setSessionKey(h),m("SessionKey updated: "+h))}catch(d){m("Failed to parse tracking response: "+d.message,"error")}}var q={CONTENT_TYPE_FORM:"application/x-www-form-urlencoded",RETRY_DELAY:2222,TIME_TO_FLUSH:5555,DEBUG:!1},h="",n={request:function(b,a,d,e,g){var f=w();if(f){f.open(b,a,!0);if(e)for(var r in e)e.hasOwnProperty(r)&&f.setRequestHeader(r,e[r]);f.withCredentials=!0;f.onreadystatechange=function(){if(4===f.readyState){var c=200<=f.status&&300>f.status||304===f.status||
1223===f.status;g&&g(c,f.responseText,f)}};f.send(d)}},get:function(b,a){this.request("GET",b,null,null,function(d,e,g){d&&a?a(e):m("GET failed: "+b,"error")})},post:function(b,a,d){this.request("POST",b,a,{"Content-Type":q.CONTENT_TYPE_FORM},function(e,g){e&&d?d(g):e||m("POST failed: "+b,"error")})},sendBeaconOrXHR:function(b,a,d,e){if(!e&&navigator.sendBeacon)try{var g=new Blob([a],{type:q.CONTENT_TYPE_FORM});if(navigator.sendBeacon(b,g)){d&&d(!0,null);return}}catch(f){m("Beacon failed, falling back to XHR",
"error")}this.post(b,a,function(f){d&&d(!0,f)})}},l={queues:{},isFlushing:{},createPayload:function(b){b=JSON.stringify(b);return"events\x3d"+encodeURIComponent(b)+(h?"\x26sessionKey\x3d"+encodeURIComponent(h):"")},enqueue:function(b,a,d){this.queues[b]||(this.queues[b]=[]);this.queues[b].push(a);this.queues[b].length>=d&&this.flush(b)},flush:function(b){var a=this,d=this.queues[b];if(d&&0!==d.length&&!this.isFlushing[b]){this.isFlushing[b]=!0;var e=d.slice(0);this.queues[b]=[];var g=e.length;d=this.createPayload(e);
var f=b+(-1===b.indexOf("?")?"?":"\x26")+"eventcount\x3d"+g;n.sendBeaconOrXHR(f,d,function(r,c){a.isFlushing[b]=!1;r?(c&&u(c),m("Batch sent successfully ("+(c?"XHR":"Beacon")+"): "+g+" events")):(m("Batch failed. Restoring data.","error"),a.queues[b]=e.concat(a.queues[b]))},""===h||!h)}}};setInterval(function(){for(var b in l.queues)l.queues.hasOwnProperty(b)&&l.flush(b)},q.TIME_TO_FLUSH);window.addEventListener&&window.addEventListener("unload",function(){for(var b in l.queues)l.queues.hasOwnProperty(b)&&
l.flush(b)});p.LeoCorsRequest={setSessionKey:function(b){b&&""!==b&&(h=b)},get:function(b){n.get(b,u)},post:function(b,a){n.post(b,a,u)},batchSend:function(b,a,d){l.enqueue(b,a,d||10)}}})("undefined"===typeof window?this:window);
(function(p,m){"function"===typeof define&&define.amd?define([],m):"undefined"!==typeof module&&module.exports?module.exports=m():p.lscache=m()})(this,function(){function p(){if(void 0!==e)return e;try{if("object"!==typeof window.localStorage)return!1;u("__lscachetest__","__lscachetest__");q("__lscachetest__");e=!0}catch(c){console.error(c),e=m(c)&&localStorage.length?!0:!1}return e}function m(c){return c&&("QUOTA_EXCEEDED_ERR"===c.name||"NS_ERROR_DOM_QUOTA_REACHED"===c.name||"QuotaExceededError"===
c.name)}function w(){void 0===g&&(g=null!=window.JSON);return g}function u(c,k){localStorage.removeItem("leocache-"+f+c);localStorage.setItem("leocache-"+f+c,k)}function q(c){localStorage.removeItem("leocache-"+f+c)}function h(c){for(var k=new RegExp("^leocache-"+f.replace(/[[\]{}()*+?.\\^$|]/g,"\\$\x26")+"(.*)"),v=localStorage.length-1;0<=v;--v){var t=localStorage.key(v);(t=(t=t&&t.match(k))&&t[1])&&0>t.indexOf("-cacheexpiration")&&c(t,t+"-cacheexpiration")}}function n(c){var k=c+"-cacheexpiration";
q(c);q(k)}function l(c){var k=c+"-cacheexpiration",v=localStorage.getItem("leocache-"+f+k);if(v&&(v=parseInt(v,10),Math.floor((new Date).getTime()/a)>=v))return q(c),q(k),!0}function b(c,k){r&&"console"in window&&"function"===typeof window.console.warn&&(window.console.warn("lscache - "+c),k&&window.console.warn("lscache - The error was: "+k.message))}var a=6E4,d=Math.floor(864E13/a),e,g,f="",r=!1;return{set:function(c,k,v){if(!p()||!w())return!1;try{k=JSON.stringify(k)}catch(z){return!1}try{u(c,
k)}catch(z){if(m(z)){var t=[];h(function(y,x){x=(x=localStorage.getItem("leocache-"+f+x))?parseInt(x,10):d;t.push({key:y,size:(localStorage.getItem("leocache-"+f+y)||"").length,expiration:x})});t.sort(function(y,x){return x.expiration-y.expiration});for(var A=(k||"").length;t.length&&0<A;){var B=t.pop();b("Cache is full, removing item with key '"+c+"'");n(B.key);A-=B.size}try{u(c,k)}catch(y){return b("Could not add item with key '"+c+"', perhaps it's too big?",y),!1}}else return b("Could not add item with key '"+
c+"'",z),!1}v?u(c+"-cacheexpiration",(Math.floor((new Date).getTime()/a)+v).toString(10)):q(c+"-cacheexpiration");return!0},get:function(c){if(!p()||l(c))return null;c=localStorage.getItem("leocache-"+f+c);if(!c||!w())return c;try{return JSON.parse(c)}catch(k){return c}},remove:function(c){p()&&n(c)},supported:function(){return p()},flush:function(){p()&&h(function(c){n(c)})},flushExpired:function(){p()&&h(function(c){l(c)})},setBucket:function(c){f=c},resetBucket:function(){f=""},getExpiryMilliseconds:function(){return a},
setExpiryMilliseconds:function(c){a=c;d=Math.floor(864E13/a)},enableWarnings:function(c){r=c}}});var leoSessionStringKey="leoctxsk",leoVisitorIdStringKey="leocdp_vid";
(function(p,m){function w(a){l=a;lscache.set(leoSessionStringKey,l)}function u(a){l=lscache.get(leoSessionStringKey);"string"!==typeof l&&!0===a&&(l="");return l}function q(){if("string"===typeof INJECTED_VISITOR_ID)return INJECTED_VISITOR_ID;var a=(new Date).getTime();return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(d){var e=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==d?e:e&3|8).toString(16)})}function h(){var a=leoVisitorIdStringKey,d=lscache.get(a);"string"===typeof INJECTED_VISITOR_ID&&
"string"===typeof d&&d!==INJECTED_VISITOR_ID&&(d=INJECTED_VISITOR_ID,lscache.flush(),setTimeout(function(){lscache.set(a,d)},200));"string"!==typeof d&&(d=q(),lscache.set(a,d));return d}var n={fingerprintId:""},l=!1,b=function(a){OBSERVE_WITH_FINGERPRINT&&(a.fgp=lscache.get("leocdp_fgp")||n.fingerprintId);return Object.keys(a).map(d=>encodeURIComponent(d)+"\x3d"+encodeURIComponent(a[d])).join("\x26")};n.doTracking=function(a,d){var e=u(!0);LeoCorsRequest.setSessionKey(e);var g=Number.parseInt(d.batchsize||
1);delete d.batchsize;d.visid=h();var f=b(d),r=!1,c=PREFIX_EVENT_VIEW_URL;"action"===a?(c=PREFIX_EVENT_ACTION_URL,r=!0):"conversion"===a?(c=PREFIX_EVENT_CONVERSION_URL,r=!0):"feedback"===a&&(c=PREFIX_EVENT_FEEDBACK_URL,r=!0);r?(a=c+"?ctxsk\x3d"+e,1>=g?LeoCorsRequest.post(a,f):LeoCorsRequest.batchSend(a,d,g)):(a=c+"?"+f+"\x26ctxsk\x3d"+e,LeoCorsRequest.get(a));console.log("LeoCorsRequest url "+a)};n.getContextSession=function(a){var d=u();"string"!==typeof d||""===d?(a=b(a),d=h(),LeoCorsRequest.get(PREFIX_SESSION_INIT_URL+
"?"+a+"\x26visid\x3d"+d,function(e,g){e=JSON.parse(g);if(101===e.status){w(e.sessionKey);g=h();var f=e.visitorId;"string"===typeof f&&f!==g&&lscache.set(leoVisitorIdStringKey,f);sendMessage("LeoObserverProxyReady");window.console&&window.console.log(e)}else console.error(e)})):sendMessage("LeoObserverProxyReady")};n.updateProfile=function(a){a.visid=h();a=b(a);var d=u();LeoCorsRequest.post(PREFIX_UPDATE_PROFILE_URL+"?ctxsk\x3d"+d,a,function(e,g){})};n.initFingerprint=function(a){Fingerprint2.get({excludes:{enumerateDevices:!0,
deviceMemory:!0}},function(d){d=d.map(function(e){return e.value});d=Fingerprint2.x64hash128(d.join(""),31);lscache.set("leocdp_fgp",d);"function"===typeof a&&a(d)})};n.getVisitorId=h;n.setSessionKey=w;p.LeoEventObserver=n})("undefined"===typeof window?this:window);