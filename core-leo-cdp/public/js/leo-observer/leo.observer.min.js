/**
 * LeoEventObserver version 0.9.1 - built on 2025.10.16
 */

'use strict';(function(q,w){function u(e){window.console&&window.console.error(e)}function v(){var e=window.ActiveXObject&&"file:"===location.protocol;if(window.XMLHttpRequest&&!e)return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(g){}u("Your browser doesn't support XML handling!");return null}function m(e){return 0==e.status||200<=e.status&&300>e.status||304==e.status||1223==e.status}q.LeoCorsRequest={get:function(e,g,r,c){var a=null,d=function(){if(0==a.readyState||
4==a.readyState)if(m(a)){for(var h={},k=0;k<r.length;k++){var f=r[k],n=a.getResponseHeader(f);n&&(h[f]=n)}c(h,a.responseText)}else u("Operation failed by LeoCorsRequest.get: "+g)};a||(a=v());a&&(a.open("GET",g,!0),a.onreadystatechange=d,a.withCredentials=e,a.send())},post:function(e,g,r,c,a){var d=null,h=function(){if((0==d.readyState||4==d.readyState)&&200==d.status)if(m(d)){for(var k={},f=0;f<r.length;f++){var n=r[f],b=d.getResponseHeader(n);b&&(k[n]=b)}a(k,d.responseText)}else u("Operation failed by LeoCorsRequest.post: "+
g)};d||(d=v());d&&(d.open("POST",g,!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.onreadystatechange=h,d.withCredentials=e,d.send(c))}}})("undefined"===typeof window?this:window);
(function(q,w){"function"===typeof define&&define.amd?define([],w):"undefined"!==typeof module&&module.exports?module.exports=w():q.lscache=w()})(this,function(){function q(){if(void 0!==h)return h;try{if("object"!==typeof window.localStorage)return!1;v("__lscachetest__","__lscachetest__");m("__lscachetest__");h=!0}catch(b){console.error(b),h=w(b)&&localStorage.length?!0:!1}return h}function w(b){return b&&("QUOTA_EXCEEDED_ERR"===b.name||"NS_ERROR_DOM_QUOTA_REACHED"===b.name||"QuotaExceededError"===
b.name)}function u(){void 0===k&&(k=null!=window.JSON);return k}function v(b,l){localStorage.removeItem("leocache-"+f+b);localStorage.setItem("leocache-"+f+b,l)}function m(b){localStorage.removeItem("leocache-"+f+b)}function e(b){for(var l=new RegExp("^leocache-"+f.replace(/[[\]{}()*+?.\\^$|]/g,"\\$\x26")+"(.*)"),t=localStorage.length-1;0<=t;--t){var p=localStorage.key(t);(p=(p=p&&p.match(l))&&p[1])&&0>p.indexOf("-cacheexpiration")&&b(p,p+"-cacheexpiration")}}function g(b){var l=b+"-cacheexpiration";
m(b);m(l)}function r(b){var l=b+"-cacheexpiration",t=localStorage.getItem("leocache-"+f+l);if(t&&(t=parseInt(t,10),Math.floor((new Date).getTime()/a)>=t))return m(b),m(l),!0}function c(b,l){n&&"console"in window&&"function"===typeof window.console.warn&&(window.console.warn("lscache - "+b),l&&window.console.warn("lscache - The error was: "+l.message))}var a=6E4,d=Math.floor(864E13/a),h,k,f="",n=!1;return{set:function(b,l,t){if(!q()||!u())return!1;try{l=JSON.stringify(l)}catch(z){return!1}try{v(b,
l)}catch(z){if(w(z)){var p=[];e(function(y,x){x=(x=localStorage.getItem("leocache-"+f+x))?parseInt(x,10):d;p.push({key:y,size:(localStorage.getItem("leocache-"+f+y)||"").length,expiration:x})});p.sort(function(y,x){return x.expiration-y.expiration});for(var A=(l||"").length;p.length&&0<A;){var B=p.pop();c("Cache is full, removing item with key '"+b+"'");g(B.key);A-=B.size}try{v(b,l)}catch(y){return c("Could not add item with key '"+b+"', perhaps it's too big?",y),!1}}else return c("Could not add item with key '"+
b+"'",z),!1}t?v(b+"-cacheexpiration",(Math.floor((new Date).getTime()/a)+t).toString(10)):m(b+"-cacheexpiration");return!0},get:function(b){if(!q()||r(b))return null;b=localStorage.getItem("leocache-"+f+b);if(!b||!u())return b;try{return JSON.parse(b)}catch(l){return b}},remove:function(b){q()&&g(b)},supported:function(){return q()},flush:function(){q()&&e(function(b){g(b)})},flushExpired:function(){q()&&e(function(b){r(b)})},setBucket:function(b){f=b},resetBucket:function(){f=""},getExpiryMilliseconds:function(){return a},
setExpiryMilliseconds:function(b){a=b;d=Math.floor(864E13/a)},enableWarnings:function(b){n=b}}});var leoSessionStringKey="leoctxsk",leoVisitorIdStringKey="leocdp_vid";
(function(q,w){function u(c){g=lscache.get(leoSessionStringKey);"string"!==typeof g&&!0===c&&(g="");return g}function v(){if("string"===typeof INJECTED_VISITOR_ID)return INJECTED_VISITOR_ID;var c=(new Date).getTime();return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(a){var d=(c+16*Math.random())%16|0;c=Math.floor(c/16);return("x"==a?d:d&3|8).toString(16)})}function m(){var c=leoVisitorIdStringKey,a=lscache.get(c);"string"===typeof INJECTED_VISITOR_ID&&"string"===typeof a&&a!==INJECTED_VISITOR_ID&&
(a=INJECTED_VISITOR_ID,lscache.flush(),setTimeout(function(){lscache.set(c,a)},200));"string"!==typeof a&&(a=v(),lscache.set(c,a));return a}var e={fingerprintId:""},g=!1,r=function(c){OBSERVE_WITH_FINGERPRINT&&(c.fgp=lscache.get("leocdp_fgp")||e.fingerprintId);return Object.keys(c).map(a=>encodeURIComponent(a)+"\x3d"+encodeURIComponent(c[a])).join("\x26")};e.doTracking=function(c,a,d){var h=u(!0);d=function(n,b){n=JSON.parse(b);n.sessionKey&&h!==n.sessionKey&&(g=n.sessionKey,lscache.set(leoSessionStringKey,
g))};a.visid=m();a=r(a);var k=!1,f=PREFIX_EVENT_VIEW_URL;"action"===c?(f=PREFIX_EVENT_ACTION_URL,k=!0):"conversion"===c?(f=PREFIX_EVENT_CONVERSION_URL,k=!0):"feedback"===c&&(f=PREFIX_EVENT_FEEDBACK_URL,k=!0);c="";k?(c=f+"?ctxsk\x3d"+h,LeoCorsRequest.post(!1,c,[],a,d)):(c=f+"?"+a+"\x26ctxsk\x3d"+h,LeoCorsRequest.get(!1,c,[],d));console.log("LeoCorsRequest url "+c)};e.getContextSession=function(c){var a=u();"string"!==typeof a||""===a?(c=r(c),a=m(),LeoCorsRequest.get(!1,PREFIX_SESSION_INIT_URL+"?"+
c+"\x26visid\x3d"+a,[],function(d,h){d=JSON.parse(h);if(101===d.status){g=d.sessionKey;lscache.set(leoSessionStringKey,g);h=m();var k=d.visitorId;"string"===typeof k&&k!==h&&lscache.set(leoVisitorIdStringKey,k);sendMessage("LeoObserverProxyReady");window.console&&window.console.log(d)}else console.error(d)})):sendMessage("LeoObserverProxyReady")};e.updateProfile=function(c){c.visid=m();c=r(c);var a=u();LeoCorsRequest.post(!1,PREFIX_UPDATE_PROFILE_URL+"?ctxsk\x3d"+a,[],c,function(d,h){})};e.initFingerprint=
function(c){Fingerprint2.get({excludes:{enumerateDevices:!0,deviceMemory:!0}},function(a){a=a.map(function(d){return d.value});a=Fingerprint2.x64hash128(a.join(""),31);lscache.set("leocdp_fgp",a);e.fingerprintId=a;"function"===typeof c&&c(a)})};e.getVisitorId=m;q.LeoEventObserver=e})("undefined"===typeof window?this:window);