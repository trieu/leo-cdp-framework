// Version: v_0.9.0_2025-12-15-16-55-57
'use strict';(function(p){function m(c,a){window.console&&("error"===a?window.console.error("[LeoCDP] "+c):q.DEBUG&&window.console.log("[LeoCDP] "+c))}function w(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(c){return m("XHR not supported.","error"),null}}function t(c){if("string"===typeof c&&0<c.length)try{var a=JSON.parse(c);a.sessionKey&&h!==a.sessionKey&&(h=a.sessionKey,p.LeoEventObserver&&"function"===typeof p.LeoEventObserver.setSessionKey&&
p.LeoEventObserver.setSessionKey(h),m("SessionKey updated: "+h))}catch(b){m("Failed to parse tracking response: "+b.message,"error")}}var q={CONTENT_TYPE_FORM:"application/x-www-form-urlencoded",RETRY_DELAY:2222,TIME_TO_FLUSH:5555,DEBUG:!1},h="",n={request:function(c,a,b,e,g){var f=w();if(f){f.open(c,a,!0);if(e)for(var u in e)e.hasOwnProperty(u)&&f.setRequestHeader(u,e[u]);f.withCredentials=!0;f.onreadystatechange=function(){if(4===f.readyState){var d=200<=f.status&&300>f.status||304===f.status||
1223===f.status;g&&g(d,f.responseText,f)}};f.send(b)}},get:function(c,a){this.request("GET",c,null,null,function(b,e,g){b&&a?a(e):m("GET failed: "+c,"error")})},post:function(c,a,b){this.request("POST",c,a,{"Content-Type":q.CONTENT_TYPE_FORM},function(e,g){e&&b?b(g):e||m("POST failed: "+c,"error")})},sendBeaconOrXHR:function(c,a,b,e){if(!e&&navigator.sendBeacon)try{var g=new Blob([a],{type:q.CONTENT_TYPE_FORM});if(navigator.sendBeacon(c,g)){b&&b(!0,null);return}}catch(f){m("Beacon failed, falling back to XHR",
"error")}this.post(c,a,function(f){b&&b(!0,f)})}},l={queues:{},isFlushing:{},createPayload:function(c){c=JSON.stringify(c);return"events\x3d"+encodeURIComponent(c)+(h?"\x26sessionKey\x3d"+encodeURIComponent(h):"")},enqueue:function(c,a,b){this.queues[c]||(this.queues[c]=[]);this.queues[c].push(a);this.queues[c].length>=b&&this.flush(c)},flush:function(c){var a=this,b=this.queues[c];if(b&&0!==b.length&&!this.isFlushing[c]){this.isFlushing[c]=!0;var e=b.slice(0);this.queues[c]=[];var g=e.length;b=this.createPayload(e);
var f=c+(-1===c.indexOf("?")?"?":"\x26")+"evc\x3d"+g;n.sendBeaconOrXHR(f,b,function(u,d){a.isFlushing[c]=!1;u?(d&&t(d),m("Batch sent successfully ("+(d?"XHR":"Beacon")+"): "+g+" events")):(m("Batch failed. Restoring data.","error"),a.queues[c]=e.concat(a.queues[c]))},""===h||!h)}}};setInterval(function(){for(var c in l.queues)l.queues.hasOwnProperty(c)&&l.flush(c)},q.TIME_TO_FLUSH);window.addEventListener&&window.addEventListener("unload",function(){for(var c in l.queues)l.queues.hasOwnProperty(c)&&
l.flush(c)});p.LeoCorsRequest={setSessionKey:function(c){c&&""!==c&&(h=c)},get:function(c){n.get(c,t)},post:function(c,a){n.post(c,a,t)},batchSend:function(c,a,b){l.enqueue(c,a,b||10)}}})("undefined"===typeof window?this:window);
(function(p,m){"function"===typeof define&&define.amd?define([],m):"undefined"!==typeof module&&module.exports?module.exports=m():p.lscache=m()})(this,function(){function p(){if(void 0!==e)return e;try{if("object"!==typeof window.localStorage)return!1;t("__lscachetest__","__lscachetest__");q("__lscachetest__");e=!0}catch(d){console.error(d),e=m(d)&&localStorage.length?!0:!1}return e}function m(d){return d&&("QUOTA_EXCEEDED_ERR"===d.name||"NS_ERROR_DOM_QUOTA_REACHED"===d.name||"QuotaExceededError"===
d.name)}function w(){void 0===g&&(g=null!=window.JSON);return g}function t(d,k){localStorage.removeItem("leocache-"+f+d);localStorage.setItem("leocache-"+f+d,k)}function q(d){localStorage.removeItem("leocache-"+f+d)}function h(d){for(var k=new RegExp("^leocache-"+f.replace(/[[\]{}()*+?.\\^$|]/g,"\\$\x26")+"(.*)"),v=localStorage.length-1;0<=v;--v){var r=localStorage.key(v);(r=(r=r&&r.match(k))&&r[1])&&0>r.indexOf("-cacheexpiration")&&d(r,r+"-cacheexpiration")}}function n(d){var k=d+"-cacheexpiration";
q(d);q(k)}function l(d){var k=d+"-cacheexpiration",v=localStorage.getItem("leocache-"+f+k);if(v&&(v=parseInt(v,10),Math.floor((new Date).getTime()/a)>=v))return q(d),q(k),!0}function c(d,k){u&&"console"in window&&"function"===typeof window.console.warn&&(window.console.warn("lscache - "+d),k&&window.console.warn("lscache - The error was: "+k.message))}var a=6E4,b=Math.floor(864E13/a),e,g,f="",u=!1;return{set:function(d,k,v){if(!p()||!w())return!1;try{k=JSON.stringify(k)}catch(z){return!1}try{t(d,
k)}catch(z){if(m(z)){var r=[];h(function(y,x){x=(x=localStorage.getItem("leocache-"+f+x))?parseInt(x,10):b;r.push({key:y,size:(localStorage.getItem("leocache-"+f+y)||"").length,expiration:x})});r.sort(function(y,x){return x.expiration-y.expiration});for(var A=(k||"").length;r.length&&0<A;){var B=r.pop();c("Cache is full, removing item with key '"+d+"'");n(B.key);A-=B.size}try{t(d,k)}catch(y){return c("Could not add item with key '"+d+"', perhaps it's too big?",y),!1}}else return c("Could not add item with key '"+
d+"'",z),!1}v?t(d+"-cacheexpiration",(Math.floor((new Date).getTime()/a)+v).toString(10)):q(d+"-cacheexpiration");return!0},get:function(d){if(!p()||l(d))return null;d=localStorage.getItem("leocache-"+f+d);if(!d||!w())return d;try{return JSON.parse(d)}catch(k){return d}},remove:function(d){p()&&n(d)},supported:function(){return p()},flush:function(){p()&&h(function(d){n(d)})},flushExpired:function(){p()&&h(function(d){l(d)})},setBucket:function(d){f=d},resetBucket:function(){f=""},getExpiryMilliseconds:function(){return a},
setExpiryMilliseconds:function(d){a=d;b=Math.floor(864E13/a)},enableWarnings:function(d){u=d}}});var leoSessionStringKey="leoctxsk",leoVisitorIdStringKey="leocdp_vid";
(function(p,m){function w(a){l=a;lscache.set(leoSessionStringKey,l)}function t(a){l=lscache.get(leoSessionStringKey);"string"!==typeof l&&!0===a&&(l="");return l}function q(){if("string"===typeof INJECTED_VISITOR_ID)return INJECTED_VISITOR_ID;var a=(new Date).getTime();return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(b){var e=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==b?e:e&3|8).toString(16)})}function h(){var a=leoVisitorIdStringKey,b=lscache.get(a);"string"===typeof INJECTED_VISITOR_ID&&
"string"===typeof b&&b!==INJECTED_VISITOR_ID&&(b=INJECTED_VISITOR_ID,lscache.flush(),setTimeout(function(){lscache.set(a,b)},200));"string"!==typeof b&&(b=q(),lscache.set(a,b));return b}var n={fingerprintId:""},l=!1,c=function(a){OBSERVE_WITH_FINGERPRINT&&(a.fgp=lscache.get("leocdp_fgp")||n.fingerprintId);return Object.keys(a).map(b=>encodeURIComponent(b)+"\x3d"+encodeURIComponent(a[b])).join("\x26")};n.doTracking=function(a,b){var e=t(!0);LeoCorsRequest.setSessionKey(e);var g=Number.parseInt(b.batchsize||
1);delete b.batchsize;var f=b.screen||"";delete b.screen;b.visid=h();var u=c(b),d=PREFIX_EVENT_VIEW_URL;"action"===a?d=PREFIX_EVENT_ACTION_URL:"conversion"===a?d=PREFIX_EVENT_CONVERSION_URL:"feedback"===a&&(d=PREFIX_EVENT_FEEDBACK_URL);a=d+"?ctxsk\x3d"+e+"\x26screen\x3d"+f;1>=g?(LeoCorsRequest.post(a,u),console.log("LeoCorsRequest post "+a,u)):(LeoCorsRequest.batchSend(a,b,g),console.log("LeoCorsRequest batchSend "+a,b))};n.getContextSession=function(a){var b=t();"string"!==typeof b||""===b?(a=c(a),
b=h(),LeoCorsRequest.get(PREFIX_SESSION_INIT_URL+"?"+a+"\x26visid\x3d"+b,function(e,g){e=JSON.parse(g);if(101===e.status){w(e.sessionKey);g=h();var f=e.visitorId;"string"===typeof f&&f!==g&&lscache.set(leoVisitorIdStringKey,f);sendMessage("LeoObserverProxyReady");window.console&&window.console.log(e)}else console.error(e)})):sendMessage("LeoObserverProxyReady")};n.updateProfile=function(a){a.visid=h();a=c(a);var b=t();LeoCorsRequest.post(PREFIX_UPDATE_PROFILE_URL+"?ctxsk\x3d"+b,a,function(e,g){})};
n.initFingerprint=function(a){Fingerprint2.get({excludes:{enumerateDevices:!0,deviceMemory:!0}},function(b){b=b.map(function(e){return e.value});b=Fingerprint2.x64hash128(b.join(""),31);lscache.set("leocdp_fgp",b);"function"===typeof a&&a(b)})};n.getVisitorId=h;n.setSessionKey=w;p.LeoEventObserver=n})("undefined"===typeof window?this:window);