/**
 * LeoEventObserver version 1.0.0 - built on 2023.11.07
 */

(function(q,w){function u(e){window.console&&window.console.error(e)}function v(){var e=window.ActiveXObject&&"file:"===location.protocol;if(window.XMLHttpRequest&&!e)return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(m){}u("Your browser doesn't support XML handling!");return null}function l(e){return 0==e.status||200<=e.status&&300>e.status||304==e.status||1223==e.status}q.LeoCorsRequest={get:function(e,m,r,c){var b=null,d=function(){if(0==b.readyState||4==b.readyState)if(l(b)){for(var k=
{},g=0;g<r.length;g++){var f=r[g],n=b.getResponseHeader(f);n&&(k[f]=n)}c(k,b.responseText)}else u("Operation failed by LeoCorsRequest.get: "+m)};b||(b=v());b&&(b.open("GET",m,!0),b.onreadystatechange=d,b.withCredentials=e,b.send())},post:function(e,m,r,c,b){var d=null,k=function(){if((0==d.readyState||4==d.readyState)&&200==d.status)if(l(d)){for(var g={},f=0;f<r.length;f++){var n=r[f],a=d.getResponseHeader(n);a&&(g[n]=a)}b(g,d.responseText)}else u("Operation failed by LeoCorsRequest.post: "+m)};d||
(d=v());d&&(d.open("POST",m,!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.onreadystatechange=k,d.withCredentials=e,d.send(c))}}})("undefined"===typeof window?this:window);
(function(q,w){"function"===typeof define&&define.amd?define([],w):"undefined"!==typeof module&&module.exports?module.exports=w():q.lscache=w()})(this,function(){function q(){if(void 0!==k)return k;try{if("object"!==typeof window.localStorage)return!1;v("__lscachetest__","__lscachetest__");l("__lscachetest__");k=!0}catch(a){console.error(a),k=w(a)&&localStorage.length?!0:!1}return k}function w(a){return a&&("QUOTA_EXCEEDED_ERR"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name||"QuotaExceededError"===
a.name)}function u(){void 0===g&&(g=null!=window.JSON);return g}function v(a,h){localStorage.removeItem("leocache-"+f+a);localStorage.setItem("leocache-"+f+a,h)}function l(a){localStorage.removeItem("leocache-"+f+a)}function e(a){for(var h=new RegExp("^leocache-"+f.replace(/[[\]{}()*+?.\\^$|]/g,"\\$&")+"(.*)"),t=localStorage.length-1;0<=t;--t){var p=localStorage.key(t);(p=(p=p&&p.match(h))&&p[1])&&0>p.indexOf("-cacheexpiration")&&a(p,p+"-cacheexpiration")}}function m(a){var h=a+"-cacheexpiration";
l(a);l(h)}function r(a){var h=a+"-cacheexpiration",t=localStorage.getItem("leocache-"+f+h);if(t&&(t=parseInt(t,10),Math.floor((new Date).getTime()/b)>=t))return l(a),l(h),!0}function c(a,h){n&&"console"in window&&"function"===typeof window.console.warn&&(window.console.warn("lscache - "+a),h&&window.console.warn("lscache - The error was: "+h.message))}var b=6E4,d=Math.floor(864E13/b),k,g,f="",n=!1;return{set:function(a,h,t){if(!q()||!u())return!1;try{h=JSON.stringify(h)}catch(z){return!1}try{v(a,
h)}catch(z){if(w(z)){var p=[];e(function(x,A){var y=localStorage.getItem("leocache-"+f+A);y=y?parseInt(y,10):d;p.push({key:x,size:(localStorage.getItem("leocache-"+f+x)||"").length,expiration:y})});p.sort(function(x,A){return A.expiration-x.expiration});for(var B=(h||"").length;p.length&&0<B;){var C=p.pop();c("Cache is full, removing item with key '"+a+"'");m(C.key);B-=C.size}try{v(a,h)}catch(x){return c("Could not add item with key '"+a+"', perhaps it's too big?",x),!1}}else return c("Could not add item with key '"+
a+"'",z),!1}t?v(a+"-cacheexpiration",(Math.floor((new Date).getTime()/b)+t).toString(10)):l(a+"-cacheexpiration");return!0},get:function(a){if(!q()||r(a))return null;a=localStorage.getItem("leocache-"+f+a);if(!a||!u())return a;try{return JSON.parse(a)}catch(h){return a}},remove:function(a){q()&&m(a)},supported:function(){return q()},flush:function(){q()&&e(function(a){m(a)})},flushExpired:function(){q()&&e(function(a){r(a)})},setBucket:function(a){f=a},resetBucket:function(){f=""},getExpiryMilliseconds:function(){return b},
setExpiryMilliseconds:function(a){b=a;d=Math.floor(864E13/b)},enableWarnings:function(a){n=a}}});var leoSessionStringKey="leoctxsk",leoVisitorIdStringKey="leocdp_vid";
(function(q,w){function u(){return m=lscache.get(leoSessionStringKey)}function v(){if("string"===typeof INJECTED_VISITOR_ID)return INJECTED_VISITOR_ID;var c=(new Date).getTime();return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(b){var d=(c+16*Math.random())%16|0;c=Math.floor(c/16);return("x"==b?d:d&3|8).toString(16)})}function l(){var c=leoVisitorIdStringKey,b=lscache.get(c);"string"===typeof INJECTED_VISITOR_ID&&"string"===typeof b&&b!==INJECTED_VISITOR_ID&&(b=INJECTED_VISITOR_ID,
lscache.flush(),setTimeout(function(){lscache.set(c,b)},200));"string"!==typeof b&&(b=v(),lscache.set(c,b));return b}var e={fingerprintId:""},m=!1,r=function(c){OBSERVE_WITH_FINGERPRINT&&(c.fgp=lscache.get("leocdp_fgp")||e.fingerprintId);return Object.keys(c).map(function(b){return encodeURIComponent(b)+"="+encodeURIComponent(c[b])}).join("&")};e.doTracking=function(c,b,d){d=function(n,a){};b.visid=l();b=r(b);var k=u();if(k){var g=!1,f=PREFIX_EVENT_VIEW_URL;"action"===c?(f=PREFIX_EVENT_ACTION_URL,
g=!0):"conversion"===c?(f=PREFIX_EVENT_CONVERSION_URL,g=!0):"feedback"===c&&(f=PREFIX_EVENT_FEEDBACK_URL,g=!0);c="";g?(c=f+"?ctxsk="+k,LeoCorsRequest.post(!1,c,[],b,d)):(c=f+"?"+b+"&ctxsk="+k,LeoCorsRequest.get(!1,c,[],d));console.log("LeoCorsRequest url "+c)}else console.log("sessionKey is NULL")};e.getContextSession=function(c){if("string"!==typeof u()){c=r(c);var b=l();LeoCorsRequest.get(!1,PREFIX_SESSION_INIT_URL+"?"+c+"&visid="+b,[],function(d,k){var g=JSON.parse(k);if(101===g.status){m=g.sessionKey;
lscache.set(leoSessionStringKey,m,SESSION_CACHE_MINUTES);var f=l(),n=g.visitorId;"string"===typeof n&&n!==f&&lscache.set(leoVisitorIdStringKey,n);sendMessage("LeoObserverProxyReady");window.console&&window.console.log(g)}else console.error(g)})}else sendMessage("LeoObserverProxyReady")};e.updateProfile=function(c){c.visid=l();c=r(c);var b=u();LeoCorsRequest.post(!1,PREFIX_UPDATE_PROFILE_URL+"?ctxsk="+b,[],c,function(d,k){})};e.initFingerprint=function(c){Fingerprint2.get({excludes:{enumerateDevices:!0,
deviceMemory:!0}},function(b){b=b.map(function(d){return d.value});b=Fingerprint2.x64hash128(b.join(""),31);lscache.set("leocdp_fgp",b);e.fingerprintId=b;"function"===typeof c&&c(b)})};e.getVisitorId=l;q.LeoEventObserver=e})("undefined"===typeof window?this:window);